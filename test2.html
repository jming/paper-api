<!DOCTYPE html>
<meta charset="utf-8">
<style>

body {
  font: 10px sans-serif;
}

.arc path {
  stroke: #fff;
}

</style>
<body>

  <div id="div1"></div>
  <div id="div2" style="z-index:-1;position:absolute;"></div>

<script src="http://d3js.org/d3.v3.min.js"></script>
<script>

var width = 960,
    height = 600,
    // radius = Math.min(width, height) / 2;
    radius = 200;

// var color = d3.scale.ordinal()
//     // .range(["#98abc5", "#8a89a6", "#7b6888", "#6b486b", "#a05d56", "#d0743c", "#ff8c00"]);
//     // .range(['#75FFA3', '#91FFB5', '#ACFFC8', '#C8FFDA', '#E3FFED'])
//     // .range(['#52B272', '#5ECC82', ' #69E693', '#75FFA3', '#83FFAC', ''])
//     .range(['#83FFAC']);

var arc = d3.svg.arc()
    .outerRadius(radius - 10)
    .innerRadius(100);

var arc2 = d3.svg.arc()
    .outerRadius(radius*1.1 - 10)
    .innerRadius(100);

var pie = d3.layout.pie()
    .sort(null)
    .value(function(d) { return 1; });

var pie2 = d3.layout.pie()
  .sort(null)
  .value(function(d) { return d.data.population });

var svg = d3.select("#div1").append("svg")
    .attr("width", width)
    .attr("height", height)
  .append("g")
    .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

// var svg2 = d3.select("#div2").append("svg")
//     .attr("width", width)
//     .attr("height", height)
//   .append("g")
//     .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

d3.csv("data.csv", function(error, data) {

  data.forEach(function(d) {
    d.population = 1;
  });

  var g = svg.selectAll(".arc")
      .data(pie(data))
    .enter().append("g")
      .attr("class", "arc");

  g.append("path")
      .attr("d", arc)
      // .style("fill", function(d) { return color(d.data.age); });
      .style("fill", function(d) { return getColor(d); });

  g.append("text")
      .attr("transform", function(d) { return "translate(" + arc.centroid(d)+ ")"; })
      .attr("dy", ".35em")
      .style("text-anchor", "middle")
      .text(function(d) { return getText(d); });

});

// d3.csv('data2.csv', function (error, data) {
//   data.forEach(function(d) {
//     d.population = +d.population;
//   });

//   var g = svg.selectAll(".arc")
//       .data(pie(data))
//     .enter().append("g")
//       .attr("class", "arc");

//   g.append("path")
//       .attr("d", arc2)
//       // .style("fill", function(d) { return color(d.data.age); });
//       .style("fill", function(d) { return getColor(d); });

//   g.append("text")
//       .attr("transform", function(d) { return "translate(" + arc.centroid(d)+ ")"; })
//       .attr("dy", ".35em")
//       .attr('x', 10)
//       .style("text-anchor", "middle")
//       .text(function(d) { return getText(d); });

// })


function getColor(d) {
  var m = parseInt(d.data.age.split('/')[0]) - 1;
  // console.log(m);
  // var colors = ['#52B272','#5ECC82','#69E693','#75FFA3','#83FFAC','#91FFB5','#9EFFBF','#ACFFC8','#BAFFD1','#C8FFDA','#D6FFE3','#E3FFED']
  var colors = ['#FF66CC', '#FF667F', '#FF9966', '#FFE666', '#CCFF66', '#7FFF66', '#66FF99', '#66FFE6', '#66CCFF', '#667FFF', '#9966FF', '#E666FF'];
  return colors[m];
}

function getText(d) {
  var m = parseInt(d.data.age.split('/')[1]) - 1;
  if (m % 5 == 0) {
    return m;
  }
}

</script>